<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Zabbix Dashboard</title>
    <link href="lib/css/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <script src="lib/js/echarts.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* 内联 SVG 图标样式 */
        .icon {
            width: 24px;
            height: 24px;
            fill: currentColor;
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <!-- 顶部栏 -->
        <header class="header">
            <div class="header-content flex">
                <div class="flex items-center">
                    <img src="assets/zabbix.png" class="logo" alt="logo">
                    <h1>Zabbix Dashboard</h1>
                </div>
                <nav class="navbar">
                    <ul>
                        <li><a href="index.html" class="active"><i class="fas fa-tachometer-alt"></i> 仪表盘</a></li>
                        <li><a href="hosts.html"><i class="fas fa-server"></i> 主机列表</a></li>
                    </ul>
                </nav>
                <div class="header-actions">
                    <div class="last-refresh">
                        <span id="lastRefreshTime" data-i18n="settings.messages.lastRefresh"></span>
                    </div>
                    <a href="https://github.com/X-Mars" target="_blank" class="icon-btn">
                        <svg viewBox="0 0 24 24" width="24" height="24" class="icon">
                            <path fill="currentColor" d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z"/>
                        </svg>
                    </a>
                    <button id="settingsBtn" class="icon-btn">
                        <i class="fas fa-cog"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- 主要内容区 -->
        <main class="main-content flex-grow">
            <!-- 状态卡片 -->
            <div class="status-cards">
                <div class="status-card">
                    <div class="status-icon blue">
                        <svg viewBox="0 0 24 24" width="24" height="24" class="icon">
                            <path fill="currentColor" d="M4 1c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V3c0-1.1-.9-2-2-2H4zm16 18H4v-2h16v2zm0-4H4v-2h16v2zm0-4H4V3h16v8zM6 5h2v2H6V5zm0 8h2v2H6v-2zm4-8h8v2h-8V5zm0 8h8v2h-8v-2z"/>
                        </svg>
                    </div>
                    <div class="status-info">
                        <span class="status-label" data-i18n="hostCount"></span>
                        <span id="hostCount" class="status-value">--</span>
                    </div>
                </div>
                <div class="status-card">
                    <div class="status-icon red">
                        <svg viewBox="0 0 24 24" width="24" height="24" class="icon">
                            <path fill="currentColor" d="M12 2L1 21h22M12 6l7.53 13H4.47M11 10v4h2v-4m-2 6v2h2v-2"/>
                        </svg>
                    </div>
                    <div class="status-info">
                        <span class="status-label" data-i18n="currentAlerts"></span>
                        <span id="alertCount" class="status-value">--</span>
                    </div>
                </div>
            </div>

            <!-- 图表区域 -->
            <div class="charts-container">
                <div class="chart-box">
                    <div class="chart-header">
                        <h3 data-i18n="alertHistory"></h3>
                    </div>
                    <div id="trendChart" class="chart"></div>
                </div>
                <div class="chart-box">
                    <div class="chart-header">
                        <h3 data-i18n="currentAlertDistribution"></h3>
                    </div>
                    <div id="severityChart" class="chart"></div>
                </div>
            </div>
            <!-- 告警列表 -->
            <div class="alerts-list">
                <div class="list-header">
                    <h3 data-i18n="weeklyAlertHistory"></h3>
                </div>
                <div class="list-content">
                    <table>
                        <thead>
                            <tr>
                                <th data-i18n="host"></th>
                                <th data-i18n="alertContent"></th>
                                <th data-i18n="level"></th>
                                <th data-i18n="status"></th>
                                <th data-i18n="duration"></th>
                                <th data-i18n="startTime"></th>
                                <th data-i18n="endTime"></th>
                            </tr>
                        </thead>
                        <tbody id="alertsList">
                            <!-- 告警列表内容将通过 JavaScript 动态添加 -->
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <!-- 设置弹窗 -->
    <div id="settingsModal" class="modal">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h2 data-i18n="settings.title">设置</h2>
                <button class="close-btn" id="closeModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label data-i18n="settings.apiUrl">Zabbix API 地址</label>
                    <input type="text" id="apiUrl" placeholder="https://your-zabbix-server">
                </div>
                <div class="form-group">
                    <label data-i18n="settings.apiToken">API Token</label>
                    <input type="password" id="apiToken" placeholder="输入您的API Token">
                </div>
                <div class="form-group">
                    <label data-i18n="settings.refreshInterval">刷新间隔</label>
                    <select id="refreshInterval" class="form-select">
                        <option value="5000" data-i18n="settings.intervals.5s">5 秒</option>
                        <option value="30000" data-i18n="settings.intervals.30s">30 秒</option>
                        <option value="60000" data-i18n="settings.intervals.1m">1 分钟</option>
                        <option value="300000" selected data-i18n="settings.intervals.5m">5 分钟</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button id="testConnection" class="btn primary">
                    <svg viewBox="0 0 24 24" width="16" height="16" class="icon">
                        <path fill="currentColor" d="M16 7v-4h-2v4h-4v-4h-2v4h-4v2h4v4h-4v2h4v4h2v-4h4v4h2v-4h4v-2h-4v-4h4v-2h-4zm-6 6v-4h4v4h-4z"/>
                    </svg>
                    <span data-i18n="settings.testConnection">测试连接</span>
                </button>
                <button id="saveSettings" class="btn success">
                    <svg viewBox="0 0 24 24" width="16" height="16" class="icon">
                        <path fill="currentColor" d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm2 16H5V5h11.17L19 7.83V19zm-7-7c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3zM6 6h9v4H6z"/>
                    </svg>
                    <span data-i18n="settings.saveSettings">保存设置</span>
                </button>
            </div>
        </div>
    </div>

    <div id="hostsModal" class="modal">
        <div class="modal-overlay"></div>
        <div class="modal-content" style="width: 80%; max-width: none;">
            <div class="modal-header">
                <h2 data-i18n="hostList"></h2>
                <button class="close-btn" id="closeHostsModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="hosts-list">
                    <table>
                        <thead>
                            <tr>
                                <th data-i18n="hostName"></th>
                                <th data-i18n="ipAddress"></th>
                                <th data-i18n="operatingSystem"></th>
                                <th class="sortable" data-sort="cpuCores" data-i18n="cpuCores"></th>
                                <th class="sortable" data-sort="memoryTotal" data-i18n="memoryTotal"></th>
                                <th class="sortable" data-sort="cpu" data-i18n="cpuUsage"></th>
                                <th class="sortable" data-sort="memory" data-i18n="memoryUsage"></th>
                                <th class="sortable" data-sort="alerts" data-i18n="alerts"></th>
                            </tr>
                        </thead>
                        <tbody id="hostsList">
                            <!-- 主机列表将通过 JavaScript 动态添加 -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- 主机详情对话框 -->
    <div id="hostDetailModal" class="modal">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h2 data-i18n="hostDetails"></h2>
                <button class="close-btn" id="closeHostDetailModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="host-detail">
                    <!-- 基本信息卡片 -->
                    <div class="detail-card">
                        <div class="detail-card-header">
                            <i class="fas fa-server"></i>
                            <span data-i18n="basicInfo"></span>
                        </div>
                        <div class="detail-card-body">
                            <div class="info-grid">
                                <div class="info-item">
                                    <label data-i18n="hostName"></label>
                                    <span id="detailHostName">-</span>
                                </div>
                                <div class="info-item">
                                    <label data-i18n="ipAddress"></label>
                                    <span id="detailHostIP">-</span>
                                </div>
                                <div class="info-item">
                                    <label data-i18n="systemType"></label>
                                    <span id="detailHostOS">-</span>
                                </div>
                                <div class="info-item">
                                    <label data-i18n="time.runningTime"></label>
                                    <span id="detailUptime">-</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 硬件信息卡片 -->
                    <div class="detail-card">
                        <div class="detail-card-header">
                            <i class="fas fa-microchip"></i>
                            <span data-i18n="hardwareInfo"></span>
                        </div>
                        <div class="detail-card-body">
                            <div class="info-grid">
                                <div class="info-item">
                                    <label data-i18n="cpuCores"></label>
                                    <span id="detailCPUCores">-</span>
                                </div>
                                <div class="info-item">
                                    <label data-i18n="memorySize"></label>
                                    <span id="detailMemoryTotal">-</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 性能监控卡片 -->
                    <div class="detail-card">
                        <div class="detail-card-header">
                            <i class="fas fa-chart-line"></i>
                            <span data-i18n="performanceMonitor"></span>
                        </div>
                        <div class="detail-card-body">
                            <div class="performance-grid">
                                <div class="performance-chart-container">
                                    <div class="chart-title">
                                        <span data-i18n="cpuUsage24h"></span>
                                        <button class="zoom-btn" data-chart="cpu">
                                            <i class="fas fa-expand"></i>
                                        </button>
                                    </div>
                                    <div id="detailCPUChart" class="performance-chart"></div>
                                </div>
                                <div class="performance-chart-container">
                                    <div class="chart-title">
                                        <span data-i18n="memoryUsage24h"></span>
                                        <button class="zoom-btn" data-chart="memory">
                                            <i class="fas fa-expand"></i>
                                        </button>
                                    </div>
                                    <div id="detailMemoryChart" class="performance-chart"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 添加放大图表的模态框 -->
                    <div id="zoomChartModal" class="modal">
                        <div class="modal-overlay"></div>
                        <div class="modal-content" style="width: 100%; max-width: none;">
                            <div class="modal-header">
                                <h2 id="zoomChartTitle"></h2>
                                <div class="time-range-buttons">
                                    <button class="time-btn" data-range="1h" data-i18n="timeButtons.1h">1小时</button>
                                    <button class="time-btn active" data-range="24h" data-i18n="timeButtons.24h">24小时</button>
                                    <button class="time-btn" data-range="7d" data-i18n="timeButtons.7d">7天</button>
                                    <button class="time-btn" data-range="15d" data-i18n="timeButtons.15d">15天</button>
                                    <button class="time-btn" data-range="30d" data-i18n="timeButtons.30d">30天</button>
                                </div>
                                <button class="close-btn" id="closeZoomChartModal">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            <div class="modal-body">
                                <div id="zoomChart" style="width: 100%; height: 80vh;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/api.js"></script>
    <script src="js/charts.js"></script>
    <script src="js/settings.js"></script>
    <script src="js/i18n.js"></script>
    <script src="js/main.js"></script>
</body>
</html> 